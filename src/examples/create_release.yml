description: Sample usage.

usage:
  version: "2.1"

  orbs:
    pipeline-feedback: instana/pipeline-feedback@1.0.0

  workflows:
    build_and_release_payment_service:
      jobs:
        - build_payment_service # In this job happens the build of your system and deployment of images in registries
        - release_payment_service: # This job deploys your containers across your infrastructure
            requires: [ build_payment_service ]

  jobs:
    build_payment_service:
      docker:
        - image: cimg/node:lts
      steps:
        - run: echo Build
    release_payment_service:
      docker:
        - image: cimg/node:lts
      steps:
        - pipeline-feedback/create_release: # Notify Instana that things are about to get interesting
            release_name: "My awesome release (CircleCI: ${CIRCLE_JOB}/${CIRCLE_BUILD_NUM})"
            release_scope: |
              {
                "applications": [
                  { "name": "My Awesome App" },
                  { "name": "My Even More Awesome App" },
                ],
                "services": [
                  { "name": "Cool service #1" },
                  {
                    "name": "Cool service #2",
                    "scopedTo": {
                      "applications": [
                        { "name": "My Cool App" }
                      ]
                    }
                  }
                ]
              }
        - run: echo "Do a lot of release"
